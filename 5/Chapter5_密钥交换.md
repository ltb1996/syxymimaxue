# 深入浅出密码学
## 第五章：密钥交换
-------------------
[幻灯片 1 - 封面]

# 密钥交换
- 基于《深入浅出密码学》第五章
- "探索如何安全地建立共享密钥"
- 作者: [您的姓名]
- 日期: [当前日期]

## 引言语
"密钥交换是现代密码学中的一个重要突破，它解决了通信双方如何在不安全信道上安全建立共享密钥的问题"
-------------------

[幻灯片 2 - 导言]

# 本章内容
1. 密钥交换的定义与应用
2. DH密钥交换算法
3. ECDH密钥交换算法
4. 安全性考虑

## 学习目标
- 理解密钥交换的基本概念
- 掌握DH和ECDH的工作原理
- 了解实践中的安全隐患

## 预备知识
- 认证加密(第4章)
- 基本密码学概念
- 简单的数学知识
-------------------

[幻灯片 3 - 密钥交换基础]

# 密钥交换的定义

## 基本场景
- Alice和Bob需要进行秘密通信
- 之前从未建立过联系
- 通信信道不安全
- 需要建立共享密钥

## 核心问题
- 如何在不安全信道上
- 安全地交换密钥
- 防止中间人获取密钥
- 确保双方得到相同密钥

## 解决方案
- 使用非对称密码技术
- 每方生成密钥对
- 通过公钥交换信息
- 各自计算共享密钥
-------------------

[幻灯片 4 - 密钥交换过程]

# 密钥交换的工作流程

## 基本步骤
1. 密钥生成
   * 双方各自生成密钥对
   * 包含公钥和私钥
   * 私钥需严格保密

2. 公钥交换
   * 双方交换各自公钥
   * 公钥可以公开传输
   * 不会泄露私钥信息

3. 密钥计算
   * 使用己方私钥
   * 结合对方公钥
   * 计算得到共享密钥

## 安全特性
- 被动攻击者无法获得共享密钥
- 即使获得所有通信内容
- 也无法推导出私钥
-------------------

[幻灯片 5 - DH密钥交换]

# Diffie-Hellman密钥交换

## 数学基础
- 基于离散对数问题
- 在有限域上运算
- 模幂运算的单向性

## 算法步骤
1. 参数选择
   * 大素数p
   * 生成元g
   * 参数需要满足特定要求

2. 密钥生成
   * 选择随机私钥a,b
   * 计算公钥A=g^a mod p
   * 计算公钥B=g^b mod p

3. 共享密钥计算
   * Alice: K=(B)^a mod p
   * Bob: K=(A)^b mod p
   * 得到相同的K=(g^(ab)) mod p
-------------------

[幻灯片 6 - ECDH密钥交换]

# 椭圆曲线DH密钥交换

## 优势特点
- 更短的密钥长度
- 更高的安全性
- 更快的计算速度
- 更少的带宽消耗

## 常用曲线
- Curve25519
  * 现代化设计
  * 高性能实现
  * 抗侧信道攻击

- NIST P-256
  * 广泛使用
  * 标准化程度高
  * 兼容性好

## 安全级别对比
- DH: 2048位≈128位安全性
- ECDH: 256位≈128位安全性
-------------------

[幻灯片 7 - 认证密钥交换]

# 认证密钥交换

## 为什么需要认证？
- 防止中间人攻击
- 确保身份真实性
- 提供双向认证

## 认证方式
1. 单向认证
   * 仅服务器认证
   * 适用于客户端众多场景
   * 如HTTPS连接

2. 双向认证
   * 双方互相认证
   * 适用于对等通信
   * 如VPN连接

## 实现机制
- 预共享公钥
- 数字证书
- 信任锚点
-------------------

[幻灯片 8 - 安全隐患]

# 实践中的安全问题

## 小子群攻击
- 攻击原理
  * 利用群结构特点
  * 发送特制公钥
  * 泄露私钥信息

- 防护措施
  * 验证公钥有效性
  * 使用安全素数
  * 检查子群阶数

## 无效曲线攻击
- 攻击方式
  * 使用其他曲线点
  * 绕过标准验证
  * 降低安全强度

- 防护方法
  * 完整的点验证
  * 检查曲线方程
  * 使用安全实现
-------------------

[幻灯片 9 - 最佳实践]

# 实践建议

## 算法选择
- 优先选择ECDH
  * 使用Curve25519
  * 或NIST P-256
  * 避免过时曲线

- 参数要求
  * DH使用2048位以上素数
  * 使用安全的素数
  * 遵循标准推荐

## 实现安全
- 公钥验证
  * 检查有效性
  * 验证范围
  * 防御已知攻击

- 随机性要求
  * 使用密码学安全随机数
  * 私钥不重用
  * 会话密钥及时更新
-------------------

[幻灯片 10 - 总结]

# 本章小结

## 核心概念
1. 密钥交换基础
   * 解决密钥分发问题
   * 非对称密码技术
   * 安全性保证

2. 主流算法
   * DH密钥交换
   * ECDH密钥交换
   * 认证机制

3. 安全考虑
   * 参数选择
   * 攻击防护
   * 实现细节

## 下一步建议
- 深入学习
  * 椭圆曲线理论
  * 具体实现细节
  * 安全性分析
- 实践应用
  * 选择安全库
  * 正确配置参数
  * 完整性验证
------------------- 